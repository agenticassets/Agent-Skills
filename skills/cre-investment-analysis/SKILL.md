---
name: cre-investment-analysis
description: Use when analyzing commercial properties, creating investment memorandums, performing DCF/IRR analysis, evaluating REIT investments, or developing CRE business plans with institutional-grade underwriting standards.
triggers:
  - commercial real estate
  - CRE
  - multifamily
  - office building
  - retail property
  - industrial property
  - DCF analysis
  - IRR
  - investment memo
  - property analysis
  - REIT
  - cap rate
  - NOI
  - underwriting
role: expert
scope: analysis
output-format: report
---

# Commercial Real Estate Investment Analysis & Business Plan

Professional-grade commercial real estate investment analysis combining academic rigor with institutional underwriting standards. This skill produces defensible, audit-ready analyses suitable for lenders, equity partners, institutional investors, and academic research.

## Core Capabilities

### Investment Analysis
- **Property Types**: Multifamily, office, retail, industrial, mixed-use, land development
- **Financial Modeling**: DCF, IRR, NPV, cash-on-cash returns, equity multiples, yield metrics
- **Underwriting**: Institutional-grade assumptions, sensitivity analysis, scenario modeling
- **Market Analysis**: Supply/demand dynamics, comparable sales/leases, submarket positioning
- **Risk Assessment**: Systematic risk factors, mitigation strategies, probability-weighted outcomes

### Business Plan Development
- **Executive Summary**: Investment thesis, value proposition, target returns
- **Market Overview**: Demographics, economic drivers, competitive landscape, barriers to entry
- **Property/Portfolio Description**: Physical characteristics, tenant mix, lease analysis, capital needs
- **Financial Projections**: 5-10 year pro formas, capital structure, waterfall distributions
- **Operations Strategy**: Property management, value-add initiatives, repositioning plans
- **Exit Strategy**: Hold period rationale, exit assumptions, multiple disposition scenarios

### Analytical Frameworks
- **Acquisition Analysis**: Purchase price justification, sources & uses, closing adjustments
- **Development Feasibility**: Land basis, hard/soft costs, construction timeline, lease-up assumptions
- **Disposition Strategy**: Hold vs. sell analysis, 1031 exchange considerations, tax implications
- **Portfolio Optimization**: Correlation analysis, geographic diversification, risk-adjusted returns
- **REIT Analysis**: FFO/AFFO metrics, same-store NOI growth, leverage ratios, dividend coverage

## Methodology

### 1. Property & Market Assessment

**Physical Analysis**
- Site characteristics (location, access, visibility, topography)
- Building specifications (square footage, age, condition, systems)
- Unit mix and layouts (for multifamily)
- Parking ratios and amenities
- Deferred maintenance assessment
- Required capital expenditures

**Market Positioning**
- Submarket definition and boundaries
- Competitive set identification
- Market rent analysis (asking vs. effective)
- Occupancy trends and absorption rates
- New supply pipeline
- Economic and demographic drivers
- Transportation and infrastructure

### 2. Financial Underwriting

**Revenue Modeling**
- In-place vs. market rents (roll-to-market analysis)
- Lease expiration schedule
- Renewal probability and rent escalations
- Vacancy and collection loss assumptions (market-based)
- Ancillary income (parking, laundry, pet fees, etc.)
- Percentage rent (for retail)

**Operating Expense Projection**
- Property taxes (actual + projected reassessment)
- Insurance (property, liability, flood if applicable)
- Utilities (tenant vs. landlord responsibility)
- Repairs and maintenance (% of EGI or per-unit/SF)
- Property management (% of EGI, typically 3-5%)
- Administrative costs
- Payroll (on-site staff if applicable)
- Contract services (landscaping, security, etc.)
- Replacement reserves ($/unit or $/SF annually)

**Capital Structure**
- Debt: LTV ratio, interest rate, amortization, IO period, prepayment penalties
- Equity: Preferred vs. common, promote structure, waterfall tiers
- Total project costs: Acquisition, closing, renovation, lease-up reserves
- Sources and uses statement

**Cash Flow Analysis**
- Levered vs. unlevered returns
- Before-tax vs. after-tax analysis
- Free cash flow to equity
- Promote/carry calculations
- Sensitivity to key variables (rent, occupancy, exit cap)

### 3. Valuation Methods

**Income Approach**
- Direct capitalization: NOI / cap rate
- Discounted Cash Flow (DCF): NPV of cash flows + reversion
- Terminal value calculation (exit cap rate or cap rate compression/expansion)

**Sales Comparison Approach**
- Price per unit (multifamily)
- Price per square foot (office, retail, industrial)
- Adjustments for condition, location, size, vintage
- Recent comparable transactions analysis

**Cost Approach** (primarily for new construction)
- Land value + replacement cost - depreciation
- Developer's profit and entrepreneurial incentive

### 4. Risk & Sensitivity Analysis

**Scenario Modeling**
- Base case (most likely)
- Downside case (conservative assumptions)
- Upside case (optimistic but achievable)

**Sensitivity Tables**
- Two-way tables (e.g., exit cap vs. rental growth)
- Monte Carlo simulation for complex portfolios
- Stress testing (recession scenario, interest rate shock)

**Key Risk Factors**
- Market risk (supply/demand imbalance)
- Lease-up risk (new construction or major repositioning)
- Interest rate risk (floating rate debt, refinance risk)
- Operational risk (management, deferred maintenance)
- Liquidity risk (ability to exit on timeline)
- Regulatory/political risk (rent control, zoning changes)

### 5. Business Plan Components

**Executive Summary** (2-3 pages)
- Investment highlights
- Property/market overview
- Financial summary (purchase price, NOI, returns)
- Value creation strategy
- Risk factors and mitigants
- Recommendation

**Market Analysis** (5-10 pages)
- Economic overview (MSA and submarket)
- Demographics and employment
- Supply and demand fundamentals
- Competitive analysis
- Market rent and occupancy trends
- Outlook and growth drivers

**Property Description** (5-10 pages)
- Location and access
- Site and improvements
- Unit/space mix
- Rent roll analysis
- Physical condition assessment
- Required capital improvements

**Financial Analysis** (10-15 pages)
- Operating pro forma (5-10 years)
- Capital budget
- Cash flow projections
- Return metrics (IRR, equity multiple, cash-on-cash)
- Sensitivity analysis
- Comparison to investment hurdles

**Operational Strategy** (3-5 pages)
- Property management approach
- Leasing strategy
- Capital improvement plan
- Value-add initiatives
- Timeline and milestones

**Exit Strategy** (2-3 pages)
- Hold period rationale
- Exit assumptions (cap rate, NOI)
- Disposition process
- Alternative exit scenarios

**Appendices**
- Detailed rent roll
- T-12 operating statements
- Property tax assessment
- Environmental Phase I
- Property condition assessment
- Market comparables
- Detailed financial model

## Working with Input Documents

Commercial real estate analysis frequently requires extracting data from various document types. This skill works seamlessly with Claude's official document processing skills to analyze input materials.

### Common Document Types in CRE Analysis

**Financial Documents**
- **Excel Spreadsheets** (.xlsx, .xlsm, .csv): Operating statements, rent rolls, financial models, budgets
- **PDF Files** (.pdf): Offering memorandums, appraisal reports, environmental reports, property condition assessments, tenant estoppels, title reports

**Presentation Materials**
- **PowerPoint** (.pptx): Investment presentations, market studies, board presentations
- **Word Documents** (.docx): Business plans, market reports, legal documents, LOIs, PSAs

### Required Skills for Document Processing

To analyze documents as inputs, you need the official Claude document skills:

- **`pdf`** - Extract text/tables from PDFs, read offering memos, appraisals
- **`xlsx`** - Read/analyze spreadsheets, extract rent rolls, operating statements
- **`docx`** - Read Word documents, extract text from reports
- **`pptx`** - Analyze presentation content, extract market data

### Installing Official Document Skills

**If you already have these skills**: Skip this section - they're already available in your environment.

**If you need to install them**:

**Option 1: Claude.ai Users**
- These skills are built-in and automatically available
- No installation needed

**Option 2: Claude Code Users**
- Skills are located at `/mnt/skills/public/` in your environment
- Available skills: `pdf`, `xlsx`, `docx`, `pptx`
- These load automatically when needed

**Option 3: Manual Installation** (if needed)
```bash
# Download from Anthropic's official skills repository
git clone https://github.com/anthropics/skills.git
cd skills/skills/

# Copy the skills you need to your Claude skills directory
cp -r docx ~/.claude/skills/
cp -r xlsx ~/.claude/skills/
cp -r pdf ~/.claude/skills/
cp -r pptx ~/.claude/skills/
```

Or visit: https://github.com/anthropics/skills

### Document Processing Workflows

#### Workflow 1: Analyzing an Offering Memorandum (PDF)

**User provides**: PDF offering memorandum for a property

**Processing steps**:
1. Use `pdf` skill to extract text and tables from the offering memo
2. Identify key data points: purchase price, NOI, rent roll, cap rate, property details
3. Use `cre-investment-analysis` skill to validate assumptions and create independent analysis
4. Cross-reference extracted data with market standards
5. Generate investment recommendation

**Example prompt**:
```
I have an offering memorandum PDF for a multifamily property. Please:
1. Extract all financial data and property information
2. Using the cre-investment-analysis skill, validate the sponsor's assumptions
3. Perform independent DCF analysis
4. Provide investment recommendation
```

#### Workflow 2: Analyzing Operating Statements (Excel)

**User provides**: T-12 operating statement in Excel

**Processing steps**:
1. Use `xlsx` skill to read and analyze the spreadsheet
2. Extract revenue, expense, and NOI data
3. Validate expense ratios against industry benchmarks (from `references/underwriting-standards.md`)
4. Identify unusual line items or inconsistencies
5. Use extracted data for pro forma projections

**Example prompt**:
```
Analyze this T-12 operating statement (Excel file) for a 200-unit apartment property:
1. Extract all revenue and expense data
2. Calculate operating expense ratio and compare to industry standards
3. Identify any red flags or unusual expenses
4. Use the cre-investment-analysis skill to project stabilized NOI
```

#### Workflow 3: Creating Investment Presentations (PowerPoint)

**User wants**: PowerPoint presentation for investment committee

**Processing steps**:
1. Use `cre-investment-analysis` skill to perform complete analysis
2. Generate key findings, financial projections, risk analysis
3. Use `pptx` skill to create professional presentation
4. Include market data, financial tables, sensitivity analysis
5. Format according to institutional standards

**Example prompt**:
```
Create an investment committee presentation using:
1. cre-investment-analysis skill to analyze this acquisition
2. pptx skill to create a 15-slide PowerPoint with:
   - Executive summary
   - Market overview
   - Property details
   - Financial analysis
   - Risk assessment
   - Recommendation
```

#### Workflow 4: Creating Professional Excel Financial Models

**User wants**: Professional CRE financial model in Excel

**Processing steps**:
1. Use `cre-investment-analysis` to define model structure and calculations
2. Use `xlsx` skill to create Excel workbook with professional formatting
3. Apply industry-standard color coding and formulas
4. Organize tabs logically (Summary, Assumptions, Pro Forma, etc.)
5. Ensure all calculations use formulas and cell references (no hardcoding)

**Example prompt**:
```
Create a professional multifamily acquisition model in Excel:

Property Details:
- 180 units, purchase price $27M
- Current NOI $1.65M
- 70% LTV financing at 6.0%

Model Requirements:
1. Summary tab with all key metrics
2. Assumptions tab (color-coded inputs)
3. 10-year operating pro forma
4. Debt amortization schedule
5. Cash flow waterfall
6. Sensitivity tables (IRR vs. exit cap and rent growth)

CRITICAL: Use formulas and cell references throughout - no hardcoded values except in Assumptions tab. Follow professional CRE formatting standards.
```

**Professional Excel Standards (using xlsx skill)**:
- **Blue text**: All assumption inputs (growth rates, cap rates, costs)
- **Black text**: All formulas and calculated values
- **Green text**: Cell references to other worksheets
- **Yellow highlights**: Key assumptions requiring attention
- **No hardcoding**: Every number except assumptions must be a formula
- **Cell references**: Use absolute ($B$5) and relative (B5) references appropriately
- **Consistent formulas**: Copy formulas across periods - no manual entry
- **Zero formatting**: Display zeros as "-" for cleaner presentation
- **Currency format**: Use $#,##0 with units in headers ("Revenue ($000s)")

#### Workflow 5: Extracting Rent Roll Data (Excel + Analysis)

**User provides**: Rent roll spreadsheet

**Processing steps**:
1. Use `xlsx` skill to read rent roll data
2. Calculate weighted average rent, occupancy, lease expiration schedule
3. Identify roll-to-market opportunities
4. Use `cre-investment-analysis` to project rental income with lease-up assumptions
5. Generate value-add analysis

**Example prompt**:
```
I have a rent roll Excel file. Please:
1. Extract all unit-level data (unit #, beds/baths, SF, current rent, lease expiration)
2. Calculate weighted average rent and occupancy
3. Compare to market rents (Austin, TX - Class B multifamily)
4. Using cre-investment-analysis skill, project stabilized income after roll-to-market
5. Estimate value creation from rent growth
```

#### Workflow 6: Analyzing Appraisal Reports (PDF + Word)

**User provides**: Appraisal report (PDF) and supplementary docs (Word)

**Processing steps**:
1. Use `pdf` skill to extract appraisal conclusions, comparable sales, income approach
2. Use `docx` skill to read supplementary market reports
3. Validate appraiser's assumptions against market data
4. Use `cre-investment-analysis` to perform independent valuation
5. Identify discrepancies or areas of concern

**Example prompt**:
```
Review this appraisal report (PDF) and market study (Word doc):
1. Extract the appraiser's value conclusion and methodology
2. Extract comparable sales and income approach assumptions
3. Using cre-investment-analysis skill, perform independent analysis
4. Compare results and identify any material differences
5. Provide assessment of appraisal quality
```

### Integration Best Practices

**Excel Model Creation (CRITICAL)**
When using `xlsx` skill to create CRE financial models:
1. **NO HARDCODING**: Use formulas with cell references - never hardcode values in calculation cells
2. **Color Coding**: Blue text = inputs, Black text = formulas, Green text = cross-sheet references
3. **Cell References**: All calculations must reference Assumptions tab (e.g., `=Assumptions!$B$5`)
4. **Consistent Formulas**: Copy formulas across periods - don't manually enter values
5. **Professional Formatting**: Currency as `$#,##0`, zeros as `"-"`, negatives as `(123)`
6. **Zero Errors**: Deliver models with NO #REF!, #DIV/0!, #VALUE!, or #N/A errors
7. **Documentation**: Source all blue assumption inputs in adjacent cells or comments

Example of CORRECT formula structure:
```
❌ WRONG: =1450 * 180 * 12 * 1.03
✅ CORRECT: =Assumptions!$B$8 * Assumptions!$B$5 * 12 * (1 + Assumptions!$B$9)
```

**Data Extraction Priority**
1. Always extract and validate source data before creating analysis
2. Cross-reference multiple documents when available (e.g., rent roll vs. offering memo)
3. Flag discrepancies between documents
4. Document all data sources in final output

**Quality Control**
1. Verify extracted numbers match source documents
2. Check for data entry errors or OCR mistakes (especially with PDFs)
3. Validate calculations independently
4. Compare extracted assumptions to market standards
5. **Excel Models**: Test that changing any assumption flows through entire model

**Common Document Combinations**
- **Acquisition package**: Offering memo (PDF) + T-12 (Excel) + Rent roll (Excel) + Photos
- **Due diligence**: Appraisal (PDF) + PCA (PDF) + Phase I Environmental (PDF) + Title report (PDF)
- **Underwriting**: Financial model (Excel) + Market study (Word/PDF) + Comp set (Excel)
- **Investment committee**: Analysis memo (Word) + Financial model (Excel) + Presentation (PowerPoint)

### Handling Common Document Issues

**Scanned PDFs (Non-searchable)**
- The `pdf` skill includes OCR capabilities for scanned documents
- May require additional processing time
- Verify extracted data accuracy due to OCR errors

**Protected/Encrypted PDFs**
- The `pdf` skill can handle password-protected files if password is provided
- Some restrictions may prevent text extraction

**Complex Excel Models**
- Focus on extracting key inputs and outputs
- Validate formulas when possible
- Note assumptions and limitations

**Legacy File Formats**
- `.doc` files: Convert to `.docx` before processing
- `.xls` files: Usually can be read by `xlsx` skill
- Older formats may require conversion

### Example: Complete Acquisition Analysis from Documents

**User provides**:
- Offering memorandum (PDF)
- T-12 operating statement (Excel)
- Rent roll (Excel)
- Market study (PDF)

**Complete workflow**:

```
Please analyze this multifamily acquisition opportunity:

STEP 1: Extract data from all documents
- PDF offering memo: Property details, asking price, seller's pro forma
- Excel T-12: Actual historical financials
- Excel rent roll: Unit-level data, lease expirations
- PDF market study: Market rents, occupancy, new supply

STEP 2: Validate and cross-reference
- Compare seller's pro forma to actual T-12
- Compare in-place rents to market rents
- Identify discrepancies or red flags

STEP 3: Perform independent analysis using cre-investment-analysis skill
- Create base case pro forma with conservative assumptions
- Develop 3 scenarios (base/downside/upside)
- Calculate IRR, equity multiple, cash-on-cash returns
- Perform sensitivity analysis

STEP 4: Create deliverables
- Investment memo (Word doc using docx skill)
- Financial model (Excel using xlsx skill)
- IC presentation (PowerPoint using pptx skill)

All deliverables should follow institutional formatting standards.
```

## Output Standards

### Professional Formatting
- Executive summary suitable for board presentation
- Tables and charts with institutional-quality formatting
- Color-coding: Green for actuals, yellow for key assumptions, blue for headers
- Clear labeling of units ($/SF, $/unit, %, basis points)
- Footnotes for key assumptions and data sources

### Analytical Rigor
- All assumptions clearly stated and defensible
- Market data sourced from credible providers (CoStar, REIS, LoopNet, CBRE, JLL)
- Conservative underwriting where uncertainty exists
- Explicit treatment of risk factors
- Sensitivity to institutional investor requirements

### Academic Standards
- Proper citations for market data and research
- Methodology transparency
- Replicable analysis
- Peer-reviewed frameworks (e.g., Geltner & Miller, Real Estate Principles)
- Alignment with NCREIF, NAREIT, or ULI standards where applicable

## Key Metrics & Benchmarks

### Return Metrics
- **IRR**: Target 15-20% for value-add, 8-12% for core
- **Equity Multiple**: Typically 1.5x - 2.5x over 5-7 years
- **Cash-on-Cash Return**: Year 1 typically 6-10%
- **Yield on Cost**: Development projects target 7-9%

### Underwriting Assumptions
- **Vacancy**: Market rate + 200-300 bps for stabilized properties
- **Rent Growth**: Inflation + 0-200 bps depending on market
- **Operating Expense Ratio**: 35-45% of EGI (varies by property type)
- **Management Fee**: 3-5% of EGI
- **Replacement Reserves**: $250-400/unit annually (multifamily)
- **Exit Cap Rate**: Entry cap + 25-50 bps (compression risk)

### Leverage Parameters
- **Core**: 50-65% LTV
- **Value-Add**: 60-75% LTV
- **Development**: 70-80% LTV (with mezz or pref equity)
- **DSCR**: Minimum 1.25x (typical lender requirement)

## Usage Instructions

### For Acquisition Analysis
Provide: Address/location, property type, purchase price, current NOI, unit/SF count, market data
Output: Complete investment memo with DCF, sensitivity analysis, and recommendation

### For Development Feasibility
Provide: Location, proposed use, site size, development program, estimated costs
Output: Feasibility study with pro forma, yield analysis, and risk assessment

### For Business Plan Creation
Provide: Investment strategy, target market, property type, capital structure
Output: Full business plan suitable for equity raise or lender presentation

### For REIT Analysis
Provide: REIT ticker, property types, geographic focus
Output: Investment analysis with FFO/AFFO projections, comp set comparison, buy/sell recommendation

## Quality Assurance

- Cross-check all calculations
- Verify units and conversions
- Ensure internal consistency (e.g., sources = uses)
- Validate assumptions against market data
- Check formulas in Excel models
- Review for typographical errors
- Confirm all exhibits are referenced in text

## References & Resources

### Internal References
- See `references/underwriting-standards.md` for industry benchmarks
- See `references/market-data-sources.md` for data provider guidance
- See `references/reit-analysis-framework.md` for REIT-specific metrics
- See `references/document-integration-workflows.md` for detailed workflows combining this skill with document processing skills
- See `scripts/dcf_analysis.py` for discounted cash flow calculations
- See `scripts/sensitivity_analysis.py` for scenario modeling
- See `assets/templates/` for Excel pro forma templates

### Required Document Processing Skills
To analyze input documents (offering memos, rent rolls, appraisals, financial statements), this skill integrates with Claude's official document skills:

- **`pdf`** - Extract data from offering memorandums, appraisals, reports
  - Location: `/mnt/skills/public/pdf/`
  - GitHub: https://github.com/anthropics/skills/tree/main/skills/pdf
  - Use for: Reading PDFs, extracting tables, OCR on scanned documents

- **`xlsx`** - Analyze Excel spreadsheets, rent rolls, operating statements
  - Location: `/mnt/skills/public/xlsx/`
  - GitHub: https://github.com/anthropics/skills/tree/main/skills/xlsx
  - Use for: Reading/writing Excel files, extracting financial data, **creating professional financial models**
  - **CRITICAL**: When creating models, use formulas (not hardcoded values), apply professional color coding, and follow CRE formatting standards

- **`docx`** - Process Word documents, reports, business plans
  - Location: `/mnt/skills/public/docx/`
  - GitHub: https://github.com/anthropics/skills/tree/main/skills/docx
  - Use for: Reading Word docs, creating investment memos, market reports

- **`pptx`** - Create and analyze PowerPoint presentations
  - Location: `/mnt/skills/public/pptx/`
  - GitHub: https://github.com/anthropics/skills/tree/main/skills/pptx
  - Use for: Creating investment committee presentations, board decks

These skills are automatically available in Claude.ai and Claude Code environments. If not available, see "Installing Official Document Skills" section above.
